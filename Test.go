package main

import (
	"encoding/hex"
	"fmt"
	"github.com/tarm/goserial"
	"math/rand"
	"time"
)

func main() {
	c := &serial.Config{Name: "COM4", Baud: 115200}
	s, err := serial.OpenPort(c)
	if err != nil {
		fmt.Print(err)
	}

	_, err = s.Write([]byte("78efeefe1221000000012020021808500020010002183028cc"))

	if err != nil {
		fmt.Print(err)
	}

	var DATA [9]string
	DATA[0] = "71efeefe3938304d0335333654373e53003000000000000000320100000000000100000000000027000082"
	DATA[1] = "7eefeefe0b010101010101010101010101010101010101010101eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee93"
	DATA[2] = "7fefeefe0b000a00140014000a0005000f000f000f000f000f000f000f000f000f000f000f0014000f000f000f00640069006e00730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003a"
	DATA[3] = "7befeefe00063e00007a8d00000a00000320000000000000000000890000302a00009700001fea00006100000c48000448000007ee02710002720000000000000000000002670002682020010310191280"
	DATA[4] = "76022020021808500630"
	DATA[5] = "7defeefe2000000000000000000078"
	DATA[6] = "79efeefe010000f0ffffff01010a010106010c0101011201010101010101010101010100010101010101010101010101010101000000000000000093"
	DATA[7] = "79efeefe020000000000ff0101010101010101010101010101010101010101010101010101010101010101010101010101010100000000000000007d"
	DATA[8] = "7aefeefe010001000000000202000000000200280085"

	for true {

		time.Sleep(200 * time.Millisecond)

		i := rand.Intn(8)
		data, _ := hex.DecodeString(DATA[i])
		fmt.Println(hex.EncodeToString(data))
		_, err := s.Write(data)
		if err != nil {
			fmt.Print(err)
		}

	}
}
